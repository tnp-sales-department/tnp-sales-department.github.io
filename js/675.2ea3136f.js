"use strict";(self["webpackChunksales_tnp_vue"]=self["webpackChunksales_tnp_vue"]||[]).push([[675],{80675:function(t,a,e){e.r(a),e.d(a,{default:function(){return U}});var r=e(56768);const s={key:1,class:"analitic-container"},o={class:"secondaty-chart"};function i(t,a,e,i,h,n){const l=(0,r.g2)("v-empty-state"),d=(0,r.g2)("MainChartComponent"),c=(0,r.g2)("SecondaryChartNewComponent"),C=(0,r.g2)("SecondaryChartWithAvailableComponent"),u=(0,r.g2)("SecondaryChartFullAvailableComponent");return(0,r.uX)(),(0,r.CE)(r.FK,null,[h.isShowChartData?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.Wv)(l,{key:0,headline:"Whoops, 404",image:"https://vuetifyjs.b-cdn.net/docs/images/logos/v.png"})),h.isShowChartData?((0,r.uX)(),(0,r.CE)("div",s,[(0,r.bF)(d),(0,r.Lk)("div",o,[(0,r.bF)(c),(0,r.bF)(C),(0,r.bF)(u)])])):(0,r.Q3)("",!0)],64)}const h={class:"main-chart-container"},n={class:"analitic__main-chart"},l={class:"main-chart"},d={ref:"mainChart",class:"main-chart__data"},c={class:"main-chart__buttons"},C={class:"count-data__btn"},u={class:"summ-data__btn"};function v(t,a,e,s,o,i){const v=(0,r.g2)("v-btn");return(0,r.uX)(),(0,r.CE)("div",h,[(0,r.Lk)("div",n,[(0,r.Lk)("div",l,[(0,r.Lk)("canvas",d,null,512)]),(0,r.Lk)("div",c,[(0,r.Lk)("div",C,[(0,r.bF)(v,{class:"count-btn",color:"teal",size:"small",onClick:i.showTrade},{default:(0,r.k6)((()=>a[0]||(a[0]=[(0,r.Lk)("span",null,"Торговые марки",-1)]))),_:1},8,["onClick"]),(0,r.bF)(v,{class:"count-btn",color:"teal",size:"small",onClick:i.showGrope},{default:(0,r.k6)((()=>a[1]||(a[1]=[(0,r.Lk)("span",null,"Категории",-1)]))),_:1},8,["onClick"]),(0,r.bF)(v,{class:"count-btn",color:"deep-purple-lighten-2",size:"small",onClick:i.showOnStore},{default:(0,r.k6)((()=>a[2]||(a[2]=[(0,r.Lk)("span",null,"С остатком",-1)]))),_:1},8,["onClick"]),(0,r.bF)(v,{class:"count-btn",color:"blue-lighten-1",size:"small",onClick:i.showOutOfStore},{default:(0,r.k6)((()=>a[3]||(a[3]=[(0,r.Lk)("span",null,"Без остатка",-1)]))),_:1},8,["onClick"])]),(0,r.Lk)("div",u,[(0,r.bF)(v,{class:"summ-btn",color:"teal",size:"small",onClick:i.showAllGoods},{default:(0,r.k6)((()=>a[4]||(a[4]=[(0,r.Lk)("span",null,"Товар",-1)]))),_:1},8,["onClick"]),(0,r.bF)(v,{class:"summ-btn",color:"green-darken-1",size:"small",onClick:i.showAvailable},{default:(0,r.k6)((()=>a[5]||(a[5]=[(0,r.Lk)("span",null,"Доступно",-1)]))),_:1},8,["onClick"]),(0,r.bF)(v,{class:"summ-btn",color:"orange-darken-1",size:"small",onClick:i.showReserve},{default:(0,r.k6)((()=>a[6]||(a[6]=[(0,r.Lk)("span",null,"Резерв",-1)]))),_:1},8,["onClick"])])])])])}e(98992),e(54520),e(81454),e(8872);var p=e(21510),b=e(97283),g=e(23408);b.t1.register(...b.$L,g.A);var m={name:"MainChartComponent",data(){return{screenWidth:window.innerWidth,chartType:"x",chartDatasetTextColor:null,chartGridX:null,chartGridY:null,dataForAnalysis:[],tmData:[],tmCountData:[],tmCount:0,gropeData:[],gropeCountData:[],gropeCount:0,onStoreData:[],onStoreCountData:[],onStoreCount:0,outOfStoreData:[],outOfStoreCountData:[],outOfStoreCount:0,availableAllData:[],availableAllCountData:[],availableAllCount:0,availableData:[],availableCountData:[],availableCount:0,reservData:[],reservCountData:[],reservCount:0}},methods:{updateWidth(){this.screenWidth=window.innerWidth},createDataForChart(){this.dataForAnalysis=[...p.c.getGoodAndReservData()],this.getTradeMarkData(),this.getGropeData(),this.getOnStoreData(),this.getOutOfStoreData(),this.getAllGoodsData(),this.getAvailableData(),this.getReserveData(),this.showTrade()},getTradeMarkData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Tm]=(t[a.Tm]||0)+1,t)),{}),a=Object.entries(t).map((([t,a])=>({tm:t,count:a}))).sort(((t,a)=>a.count-t.count)),e=a.map((t=>t.tm)),r=a.map((t=>t.count));this.tmData=e,this.tmCountData=r,this.tmCount=e.length},getGropeData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Grope]=(t[a.Grope]||0)+1,t)),{}),a=Object.entries(t).map((([t,a])=>({grope:t,count:a}))).sort(((t,a)=>a.count-t.count)),e=a.map((t=>t.grope)),r=a.map((t=>t.count)),s=a.reduce(((t,a)=>t+a.count),0);this.gropeData=e,this.gropeCountData=r,this.gropeCount=s},getOnStoreData(){const t=this.dataForAnalysis.filter((t=>0!==t.Available)),a=t.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=1,t)),{}),e=Object.entries(a).map((([t,a])=>({grope:t,available:a}))).sort(((t,a)=>a.available-t.available)),r=e.map((t=>t.grope)),s=e.map((t=>t.available)),o=e.reduce(((t,a)=>t+a.available),0);this.onStoreData=r,this.onStoreCountData=s,this.onStoreCount=o},getOutOfStoreData(){const t=this.dataForAnalysis.filter((t=>0===t.Available)),a=t.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=1,t)),{}),e=Object.entries(a).map((([t,a])=>({grope:t,notAvailable:a}))).sort(((t,a)=>a.notAvailable-t.notAvailable)),r=e.map((t=>t.grope)),s=e.map((t=>t.notAvailable)),o=e.reduce(((t,a)=>t+a.notAvailable),0);this.outOfStoreData=r,this.outOfStoreCountData=s,this.outOfStoreCount=o},getAllGoodsData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=a.Reserv+a.Available+a.Available2320+a.AvailableDpm,t)),{}),a=Object.entries(t).map((([t,a])=>({grope:t,available:a}))).sort(((t,a)=>a.available-t.available)),e=a.map((t=>t.grope)),r=a.map((t=>t.available)),s=a.reduce(((t,a)=>t+a.available),0);this.availableAllData=e,this.availableAllCountData=r,this.availableAllCount=s},getAvailableData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=a.Available+a.AvailableDpm+a.Available2320,t)),{}),a=Object.entries(t).map((([t,a])=>({grope:t,available:a}))).sort(((t,a)=>a.available-t.available)),e=a.map((t=>t.grope)),r=a.map((t=>t.available)),s=a.reduce(((t,a)=>t+a.available),0);this.availableData=e,this.availableCountData=r,this.availableCount=s},getReserveData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=a.Reserv,t)),{}),a=Object.entries(t).map((([t,a])=>({grope:t,reserv:a}))).sort(((t,a)=>a.reserv-t.reserv)),e=a.map((t=>t.grope)),r=a.map((t=>t.reserv)),s=a.reduce(((t,a)=>t+a.reserv),0);this.reservData=e,this.reservCountData=r,this.reservCount=s},destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)},showTrade(){this.destroyChart(),this.screenWidth<990?(this.isChangeChart="y",this.chartDatasetTextColor="transparent",this.chartGridX=!0,this.chartGridY=!0):this.screenWidth>989&&(this.isChangeChart="x",this.chartDatasetTextColor="#00897B",this.chartGridX=!1,this.chartGridY=!0);let t="СКЮ в разрезе торговых марок";this.createChart(this.tmData,this.tmCountData,t,"#00897B","#4DB6AC","СКЮ")},showGrope(){this.destroyChart(),this.screenWidth<990?(this.isChangeChart="y",this.chartDatasetTextColor="transparent",this.chartGridX=!0,this.chartGridY=!0):this.screenWidth>989&&(this.isChangeChart="x",this.chartDatasetTextColor="#00897B",this.chartGridX=!1,this.chartGridY=!0);let t=`СКЮ в разрезе категорий (${this.gropeCount.toLocaleString()} СКЮ)`;this.createChart(this.gropeData,this.gropeCountData,t,"#00897B","#4DB6AC","СКЮ")},showOnStore(){this.destroyChart(),this.screenWidth<990?(this.isChangeChart="y",this.chartDatasetTextColor="transparent",this.chartGridX=!0,this.chartGridY=!0):this.screenWidth>989&&(this.isChangeChart="x",this.chartDatasetTextColor="#7E57C2",this.chartGridX=!1,this.chartGridY=!0);let t=`СКЮ с остатком в разрезе категорий (${this.onStoreCount.toLocaleString()} СКЮ)`;this.createChart(this.onStoreData,this.onStoreCountData,t,"#7E57C2","#B39DDB","СКЮ")},showOutOfStore(){this.destroyChart(),this.screenWidth<990?(this.isChangeChart="y",this.chartDatasetTextColor="transparent",this.chartGridX=!0,this.chartGridY=!0):this.screenWidth>989&&(this.isChangeChart="x",this.chartDatasetTextColor="#1E88E5",this.chartGridX=!1,this.chartGridY=!0);let t=`СКЮ без остатка в разрезе категорий (${this.outOfStoreCount.toLocaleString()} СКЮ)`;this.createChart(this.outOfStoreData,this.outOfStoreCountData,t,"#1E88E5","#64B5F6","СКЮ")},showAllGoods(){this.destroyChart(),this.screenWidth<990?(this.isChangeChart="y",this.chartDatasetTextColor="transparent",this.chartGridX=!0,this.chartGridY=!0):this.screenWidth>989&&(this.isChangeChart="x",this.chartDatasetTextColor="#00897B",this.chartGridX=!1,this.chartGridY=!0);let t=`Все остатки товара в разрезе категорий (${this.availableAllCount.toLocaleString()} шт.)`;this.createChart(this.availableAllData,this.availableAllCountData,t,"#00897B","#4DB6AC","шт.")},showAvailable(){this.destroyChart(),this.screenWidth<990?(this.isChangeChart="y",this.chartDatasetTextColor="transparent",this.chartGridX=!0,this.chartGridY=!0):this.screenWidth>989&&(this.isChangeChart="x",this.chartDatasetTextColor="#388E3C",this.chartGridX=!1,this.chartGridY=!0);let t=`Доступный товар в разрезе категорий (${this.availableCount.toLocaleString()} шт.)`;this.createChart(this.availableData,this.availableCountData,t,"#388E3C","#66BB6A","шт.")},showReserve(){this.destroyChart(),this.screenWidth<990?(this.isChangeChart="y",this.chartDatasetTextColor="transparent",this.chartGridX=!0,this.chartGridY=!0):this.screenWidth>989&&(this.isChangeChart="x",this.chartDatasetTextColor="#F57C00",this.chartGridX=!1,this.chartGridY=!0);let t=`Зарезервированный товар в разрезе категорий (${this.reservCount.toLocaleString()} шт.)`;this.createChart(this.reservData,this.reservCountData,t,"#F57C00","#FFA726","шт.")},createChart(t,a,e,r,s,o){let i=o;const h=this.$refs.mainChart.getContext("2d"),n=h.createLinearGradient(0,0,0,400);n.addColorStop(0,r),n.addColorStop(1,s),this.chart=new b.t1(h,{type:"bar",data:{labels:t,datasets:[{label:i,data:a,backgroundColor:n,borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:this.isChangeChart,plugins:{legend:!1,subtitle:{display:!0,text:e,font:{weight:"bold",size:"14"},padding:{top:5,bottom:35}},datalabels:{color:this.chartDatasetTextColor,anchor:"end",align:"top",formatter:t=>0!==t?t.toLocaleString():""}},scales:{y:{beginAtZero:!0,grid:{display:this.chartGridY}},x:{grid:{display:this.chartGridX}}}}})}},created(){window.addEventListener("resize",this.updateWidth)},mounted(){this.createDataForChart(),window.addEventListener("resize",(()=>{this.chart&&this.chart.update()}))},beforeUnmount(){window.removeEventListener("resize",this.updateWidth),this.destroyChart()}},A=e(71241);const D=(0,A.A)(m,[["render",v],["__scopeId","data-v-b15b0734"]]);var y=D;const f={class:"secondary-chart-container"},w={class:"analitic__secondary-chart"},k={ref:"secondaryChart",class:"secondary-chart__data"};function G(t,a,e,s,o,i){return(0,r.uX)(),(0,r.CE)("div",f,[(0,r.Lk)("div",w,[(0,r.Lk)("canvas",k,null,512)])])}b.t1.register(...b.$L,g.A);var S={name:"SecondaryChartNewComponent",data(){return{dataForAnalysis:[],goodsNewCount:0,goodsOldCount:0}},methods:{createDataForChart(){this.dataForAnalysis=[...p.c.getGoodAndReservData()],this.getNewOldCount(),this.showCharts()},getNewOldCount(){const t=this.dataForAnalysis.filter((t=>"Новинка"==t.Status)),a=this.dataForAnalysis.filter((t=>"Постоянный ассортимент"==t.Status));this.goodsNewCount=t,this.goodsOldCount=a},showCharts(){this.destroyChart(),this.tradeMarkChart()},destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)},tradeMarkChart(){const t={labels:["Новый товар","Старый товар"],datasets:[{label:"СКЮ",data:[this.goodsNewCount.length,this.goodsOldCount.length],backgroundColor:["rgba(255,0,0,0.9)","rgba(128, 128, 128,0.9)"],borderColor:"white",hoverOffset:3}]},a={responsive:!0,plugins:{legend:{position:"top"},tooltip:{enabled:!0},subtitle:{display:!0,text:"Соотношение нового и старого товара",font:{weight:"bold"}},datalabels:{color:"#ffffff",anchor:"center",align:"center",formatter:t=>0!==t?t.toLocaleString():""}}},e=this.$refs.secondaryChart.getContext("2d");this.chart=new b.t1(e,{type:"doughnut",data:t,options:a})}},created(){window.addEventListener("resize",this.updateWidth)},mounted(){this.createDataForChart(),window.addEventListener("resize",(()=>{this.chart&&this.chart.update()}))},beforeUnmount(){window.removeEventListener("resize",this.updateWidth),this.destroyChart()}};const F=(0,A.A)(S,[["render",G],["__scopeId","data-v-59350e46"]]);var L=F;const O={class:"secondary-chart-container"},_={class:"analitic__secondary-chart"},W={ref:"secondaryChart",class:"secondary-chart__data"};function x(t,a,e,s,o,i){return(0,r.uX)(),(0,r.CE)("div",O,[(0,r.Lk)("div",_,[(0,r.Lk)("canvas",W,null,512)])])}b.t1.register(...b.$L,g.A);var E={name:"SecondaryChartWithAvailableComponent",data(){return{dataForAnalysis:[],goodsWithAvailable:0,goodsOutOfhAvailable:0}},methods:{createDataForChart(){this.dataForAnalysis=[...p.c.getGoodAndReservData()],this.getWithOutCount(),this.showCharts()},getWithOutCount(){const t=this.dataForAnalysis.filter((t=>t.Available+t.AvailableDpm+t.Available2320+t.Reserv!==0)),a=this.dataForAnalysis.filter((t=>t.Available+t.AvailableDpm+t.Available2320+t.Reserv===0));this.goodsWithAvailable=t,this.goodsOutOfhAvailable=a},showCharts(){this.destroyChart(),this.tradeMarkChart()},destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)},tradeMarkChart(){const t={labels:["С остатком","Без остатка"],datasets:[{label:"СКЮ",data:[this.goodsWithAvailable.length,this.goodsOutOfhAvailable.length],backgroundColor:["rgba(153, 102, 255, 0.8)","rgba(54, 162, 235, 0.8)"],borderColor:"white",hoverOffset:3}]},a={responsive:!0,plugins:{legend:{position:"top"},tooltip:{enabled:!0},subtitle:{display:!0,text:"Соотношение товара с остатком и без остатка",font:{weight:"bold"}},datalabels:{color:"#ffffff",anchor:"center",align:"center",formatter:t=>0!==t?t.toLocaleString():""}}},e=this.$refs.secondaryChart.getContext("2d");this.chart=new b.t1(e,{type:"doughnut",data:t,options:a})}},created(){window.addEventListener("resize",this.updateWidth)},mounted(){this.createDataForChart(),window.addEventListener("resize",(()=>{this.chart&&this.chart.update()}))},beforeUnmount(){window.removeEventListener("resize",this.updateWidth),this.destroyChart()}};const R=(0,A.A)(E,[["render",x],["__scopeId","data-v-7a331076"]]);var T=R;const X={class:"secondary-chart-container"},z={class:"analitic__secondary-chart"},Y={ref:"secondaryChart",class:"secondary-chart__data"};function B(t,a,e,s,o,i){return(0,r.uX)(),(0,r.CE)("div",X,[(0,r.Lk)("div",z,[(0,r.Lk)("canvas",Y,null,512)])])}b.t1.register(...b.$L,g.A);var $={name:"SecondaryChartFullAvailableComponent",data(){return{dataForAnalysis:[],goodsFullAvailable:0,goodsFullReserv:0}},methods:{updateWidth(){this.screenWidth=window.innerWidth},createDataForChart(){this.dataForAnalysis=[...p.c.getGoodAndReservData()],this.getAvailableResrvCount(),this.showCharts()},getAvailableResrvCount(){const t=this.dataForAnalysis.reduce(((t,a)=>t+a.Available+a.AvailableDpm+a.Available2320),0),a=this.dataForAnalysis.reduce(((t,a)=>t+a.Reserv),0);this.goodsFullAvailable=t,this.goodsFullReserv=a},showCharts(){this.destroyChart(),this.tradeMarkChart()},destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)},tradeMarkChart(){const t={labels:["Доступно","Резерв"],datasets:[{label:"Штук",data:[this.goodsFullAvailable,this.goodsFullReserv],backgroundColor:["rgba(28,175,0,0.8)","rgba(255,137,36,0.8)"],borderColor:"white",hoverOffset:3}]},a={responsive:!0,plugins:{legend:{position:"top"},tooltip:{enabled:!0},subtitle:{display:!0,text:"Соотношение доступного и зарезервированного товара",font:{weight:"bold"}},datalabels:{color:"#ffffff",anchor:"center",align:"center",formatter:t=>0!==t?t.toLocaleString():""}}},e=this.$refs.secondaryChart.getContext("2d");this.chart=new b.t1(e,{type:"doughnut",data:t,options:a})}},created(){window.addEventListener("resize",this.updateWidth)},mounted(){this.createDataForChart(),window.addEventListener("resize",(()=>{this.chart&&this.chart.update()}))},beforeUnmount(){window.removeEventListener("resize",this.updateWidth),this.destroyChart()}};const M=(0,A.A)($,[["render",B],["__scopeId","data-v-13fafdcc"]]);var N=M,j={name:"AnaliticComponent",components:{SecondaryChartFullAvailableComponent:N,SecondaryChartWithAvailableComponent:T,SecondaryChartNewComponent:L,MainChartComponent:y},data(){return{isShowChartData:!1,currentRole:"promoter"}},methods:{checkRole(){let t=JSON.parse(localStorage.getItem("sale-auth"));this.currentRole=t.role},isShowChart(){"promoter"===this.currentRole?this.isShowChartData=!1:this.isShowChartData=!0}},mounted(){this.checkRole(),this.isShowChart(),localStorage.setItem("checkLoadStatus","loaded")},beforeUnmount(){localStorage.removeItem("checkLoadStatus")}};const I=(0,A.A)(j,[["render",i],["__scopeId","data-v-6bb8f318"]]);var U=I}}]);
//# sourceMappingURL=675.2ea3136f.js.map